{
  "rules": {
    "matchdata": {
      ".read": "true",
      "$matchId": {
        ".validate": "newData.hasChildren()",
        "name": {
          ".validate": "true"
        },
        "nextPlayer": {
          ".validate": "true"
        },
        "board": {
          ".validate": "true"
        },
        "$other": {
          ".validate": "false"
        },
        ".write": "data.val() == null ? ((((newData.child('name').val() != null && newData.child('nextPlayer').val() == 'black') && newData.child('board').val() == null) && root.child('matches').child($matchId).val() == null) && newData.parent().parent().child('matches').child($matchId).val() != null) : newData.val() == null ? false : ((newData.child('name').val() == data.child('name').val() && newData.parent().parent().child('matches').child($matchId).child('lastMoveBy').val() != root.child('matches').child($matchId).child('lastMoveBy').val()) && (newData.parent().parent().child('matches').child($matchId).child('lastMoveBy').val() == newData.parent().parent().child('matches').child($matchId).child('black').val() ? (data.child('nextPlayer').val() == 'black' && (newData.child('nextPlayer').val() == 'white' || newData.child('nextPlayer').val() == null)) : newData.parent().parent().child('matches').child($matchId).child('lastMoveBy').val() == newData.parent().parent().child('matches').child($matchId).child('white').val() ? (data.child('nextPlayer').val() == 'white' && (newData.child('nextPlayer').val() == 'black' || newData.child('nextPlayer').val() == null)) : false))"
      }
    },
    "matches": {
      "$matchId": {
        ".validate": "newData.hasChildren()",
        "black": {
          ".validate": "true"
        },
        "white": {
          ".validate": "true"
        },
        "lastMoveBy": {
          ".validate": "true"
        },
        "$other": {
          ".validate": "false"
        },
        ".write": "data.val() == null ? ((((newData.child('black').val() != null && newData.child('white').val() == null) && newData.child('lastMoveBy').val() == null) && root.child('matchdata').child($matchId).val() == null) && newData.parent().parent().child('matchdata').child($matchId).val() != null) : newData.val() == null ? false : ((((data.child('white').val() == null && newData.child('white').val() != null) && newData.child('black').val() == data.child('black').val()) && newData.child('lastMoveBy').val() == data.child('lastMoveBy').val()) || (((newData.child('lastMoveBy').val() != data.child('lastMoveBy').val() && (newData.child('lastMoveBy').val() == newData.child('black').val() || newData.child('lastMoveBy').val() == newData.child('white').val())) && newData.child('black').val() == data.child('black').val()) && newData.child('white').val() == data.child('white').val()))"
      }
    }
  }
}
